import streamlit as st
from groq import Groq
import random
import time
import os

# --- 1. –ö–ò–ë–ï–†-–î–ò–ó–ê–ô–ù (CSS) ---
st.set_page_config(page_title="AIS MASTER ELITE", page_icon="üñ•", layout="wide")

st.markdown("""
<style>
    /* –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–æ–Ω –∏ —Ç–µ–∫—Å—Ç */
    .main { background-color: #0e1117; }
    .stMarkdown, p, span { color: #e6edf3; }
    
    /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è */
    .stTextArea textarea { 
        background-color: #161b22 !important; 
        color: #00ff66 !important; 
        border: 1px solid #30363d !important;
        font-family: 'Consolas', monospace;
    }
    
    /* –ö–Ω–æ–ø–∫–∏ */
    .stButton>button { 
        width: 100%; 
        border-radius: 8px; 
        height: 3.5em; 
        background-color: #238636; 
        color: white; 
        border: 1px solid #00ff66;
        font-weight: bold;
        transition: 0.3s;
    }
    .stButton>button:hover { 
        background-color: #2ea043; 
        box-shadow: 0 0 15px #00ff6666;
    }
    
    /* –•–∞–∫–µ—Ä—Å–∫–∏–π —Ç–µ—Ä–º–∏–Ω–∞–ª */
    .terminal-box {
        background-color: #050505;
        border-left: 5px solid #00ff66;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 20px rgba(0, 255, 102, 0.15);
        margin: 15px 0;
    }
    .terminal-text {
        color: #00ff66 !important;
        font-family: 'Consolas', 'Monaco', monospace !important;
        font-size: 15px !important;
        text-shadow: 0 0 5px rgba(0, 255, 102, 0.5);
    }
</style>
""", unsafe_allow_html=True)

# --- 2. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø GROQ ---
if "GROQ_KEY" in st.secrets:
    client = Groq(api_key=st.secrets["GROQ_KEY"])
else:
    st.error("FATAL ERROR: GROQ_KEY NOT FOUND IN SECRETS")
    st.stop()

def call_ai(system_prompt, user_input):
    try:
        completion = client.chat.completions.create(
            model="llama-3.3-70b-versatile",
            messages=[
                {"role": "system", "content": system_prompt},
                {"role": "user", "content": user_input}
            ],
            temperature=0.4,
        )
        return completion.choices[0].message.content
    except Exception as e:
        return f"CRITICAL SYSTEM ERROR: {e}"

def print_terminal(text):
    st.markdown(f'<div class="terminal-box"><p class="terminal-text">[SYSTEM LOG] >> {text}</p></div>', unsafe_allow_html=True)


# --- 3. –ë–ê–ó–ê –î–ê–ù–ù–´–• (25 –ë–ò–õ–ï–¢–û–í) ---
tickets_data = {
    "1": {"q1": "–ü–æ–Ω—è—Ç–∏–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ê–ò–°", "a1": "–ö–æ–º–ø–ª–µ–∫—Å —É—Å–ª—É–≥ –ø–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—é –±–µ—Å–ø–µ—Ä–µ–±–æ–π–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã –∏ –ø–æ–º–æ—â–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.", "q2": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ê–ò–°", "a2": "–ü–æ —Å—Ñ–µ—Ä–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è, –º–∞—Å—à—Ç–∞–±—É –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä—É –∑–∞–¥–∞—á.", "pract": "–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–∏–ø —Å–∏—Å—Ç–µ–º—ã –ø–æ –æ–ø–∏—Å–∞–Ω–∏—é.", "p_sol": "–ê–Ω–∞–ª–∏–∑ –º–∞—Å—à—Ç–∞–±–∞ –∏ —Ü–µ–ª–∏ (—É—á–µ—Ç/—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)."},
    "2": {"q1": "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ü–û", "a1": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–∞–º–∏ –ü–ö –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ä–µ–¥—ã –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–º.", "q2": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ –û–°", "a2": "–ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∏ –ª–∏—Ü–µ–Ω–∑–∏—è.", "pract": "–ü–ª–∞–Ω —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–°.", "p_sol": "–ù–æ—Å–∏—Ç–µ–ª—å -> BIOS -> –†–∞–∑–º–µ—Ç–∫–∞ -> –£—Å—Ç–∞–Ω–æ–≤–∫–∞."},
    "3": {"q1": "–≠—Ç–∞–ø—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–°", "a1": "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞, –∑–∞–≥—Ä—É–∑–∫–∞, —Ä–∞–∑–º–µ—Ç–∫–∞, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, –Ω–∞—Å—Ç—Ä–æ–π–∫–∞.", "q2": "–¢–∏–ø—ã –∑–∞–≥—Ä—É–∑–æ—á–Ω—ã—Ö –Ω–æ—Å–∏—Ç–µ–ª–µ–π", "a2": "USB, DVD, –°–µ—Ç—å, –≤–Ω–µ—à–Ω–∏–µ HDD.", "pract": "–°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∑–∞–≥—Ä—É–∑–æ—á–Ω–æ–π —Ñ–ª–µ—à–∫–∏.", "p_sol": "–í—ã–±–æ—Ä Rufus, ISO –∏ —Å—Ö–µ–º—ã MBR/GPT."},
    "4": {"q1": "–ü—Ä–∏–∫–ª–∞–¥–Ω–æ–µ –ü–û: –≤–∏–¥—ã", "a1": "–û–±—â–µ–≥–æ, —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∏ —Ä–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ.", "q2": "–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≤—ã–±–æ—Ä–∞ –ü–û", "a2": "–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª, —Ü–µ–Ω–∞, —Å–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å.", "pract": "–ü–û –¥–ª—è –æ—Ç–¥–µ–ª–∞ –ø—Ä–æ–¥–∞–∂.", "p_sol": "CRM + –û—Ñ–∏—Å–Ω—ã–π –ø–∞–∫–µ—Ç."},
    "5": {"q1": "–ú–µ—Ç–æ–¥—ã —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û", "a1": "–õ–æ–∫–∞–ª—å–Ω–∞—è, —Å–µ—Ç–µ–≤–∞—è, –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è, —Ç–∏—Ö–∞—è.", "q2": "–§–æ—Ä–º–∞—Ç—ã –ø–∞–∫–µ—Ç–æ–≤", "a2": "EXE, MSI, DMG, DEB/RPM.", "pract": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã.", "p_sol": "–ó–∞–ø—É—Å–∫ –æ—Ç –∞–¥–º–∏–Ω–∞ -> –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π."},
    "6": {"q1": "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ü–û", "a1": "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ç—á–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.", "q2": "–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –¥—Ä–∞–π–≤–µ—Ä–æ–≤", "a2": "–°–≤—è–∑—å –û–° —Å –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ–º.", "pract": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –û–°.", "p_sol": "–ü–∞—Ä–∞–º–µ—Ç—Ä—ã -> –û–±–Ω–æ–≤–ª–µ–Ω–∏—è -> –ü–æ–∏—Å–∫."},
    "7": {"q1": "–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ê–ò–°", "a1": "–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏ –∏—Ö —Å–≤—è–∑–µ–π.", "q2": "–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ê–ò–°", "a2": "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ, –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª.", "pract": "–°–æ—Å—Ç–∞–≤–∏—Ç—å —Å—Ö–µ–º—É –ê–ò–°.", "p_sol": "–ö–ª–∏–µ–Ω—Ç -> –°–µ—Ç—å -> –°–µ—Ä–≤–µ—Ä –ë–î."},
    "8": {"q1": "–û—à–∏–±–∫–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ü–û", "a1": "–ú–µ—Å—Ç–æ, –ø—Ä–∞–≤–∞, –∞–Ω—Ç–∏–≤–∏—Ä—É—Å, –±–∏—Ç—ã–π —Ñ–∞–π–ª.", "q2": "–ú–µ—Ç–æ–¥—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏", "a2": "–õ–æ–≥–∏, –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π, –∫–æ–¥—ã –æ—à–∏–±–æ–∫.", "pract": "–†–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –ø—Ä–∞–≤.", "p_sol": "–ó–∞–ø—É—Å–∫ –æ—Ç –∏–º–µ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞."},
    "9": {"q1": "–í–∏–¥—ã –æ—à–∏–±–æ–∫ –ü–û", "a1": "–õ–æ–≥–∏—á–µ—Å–∫–∏–µ, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–Ω—ã–µ, —Å–µ—Ç–µ–≤—ã–µ.", "q2": "–ú–µ—Ç–æ–¥—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è", "a2": "–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞, –æ—Ç–∫–∞—Ç.", "pract": "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ü–û.", "p_sol": "–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -> –ò–∑–º–µ–Ω–∏—Ç—å -> –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å."},
    "10": {"q1": "–°–∏—Å—Ç–µ–º–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ", "a1": "–í–µ—Ä—Å–∏—è –û–°, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –û–ó–£, –¶–ü.", "q2": "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å", "a2": "–†–∞–±–æ—Ç–∞ –ü–û –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤.", "pract": "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.", "p_sol": "–°–≤–æ–π—Å—Ç–≤–∞ —Å–∏—Å—Ç–µ–º—ã vs Requirements."},
    "11": {"q1": "–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ", "a1": "–°–æ–∑–¥–∞–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∑–∞—â–∏—Ç—ã.", "q2": "–°–ø–æ—Å–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è", "a2": "–ò–∑ –∫–æ–ø–∏–∏, —á–µ—Ä–µ–∑ —Å–æ—Ñ—Ç, –∏–∑ –æ–±—Ä–∞–∑–∞.", "pract": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –±—ç–∫–∞–ø –ø–∞–ø–∫–∏.", "p_sol": "–ò—Å—Ç–æ—á–Ω–∏–∫ -> –¶–µ–ª—å -> –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ."},
    "12": {"q1": "–¢–∏–ø—ã —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏—è", "a1": "–ü–æ–ª–Ω–æ–µ, –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ, –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ.", "q2": "–°—Ä–µ–¥—Å—Ç–≤–∞ –±—ç–∫–∞–ø–∞", "a2": "–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ, —Å—Ç–æ—Ä–æ–Ω–Ω–∏–µ (Veeam), –æ–±–ª–∞–∫–∞.", "pract": "–ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é.", "p_sol": "Full (–≤—Å) + Inc (–ø–Ω-—Å–±)."},
    "13": {"q1": "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ê–ò–°", "a1": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏.", "q2": "–ú–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏", "a2": "–û–±—â–∞—è –ë–î, —Ñ–∞–π–ª—ã, API.", "pract": "–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.", "p_sol": "–°–∞–π—Ç -> API -> 1–°."},
    "14": {"q1": "–ü—Ä–æ—Ç–æ–∫–æ–ª—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è", "a1": "–ü—Ä–∞–≤–∏–ª–∞ –ø–µ—Ä–µ–¥–∞—á–∏ (HTTP, FTP, SMTP, TCP/IP).", "q2": "–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –º–æ–¥—É–ª–µ–π", "a2": "–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ç—ã–∫–æ–≤–∫–∏ —á–∞—Å—Ç–µ–π –ü–û.", "pract": "–í—ã–±—Ä–∞—Ç—å –ø—Ä–æ—Ç–æ–∫–æ–ª.", "p_sol": "HTTPS –¥–ª—è –≤–µ–±–∞, SMTP –¥–ª—è –ø–æ—á—Ç—ã."},
    "15": {"q1": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ê–ò–°", "a1": "–°–ª–µ–∂–µ–Ω–∏–µ –∑–∞ –Ω–∞–≥—Ä—É–∑–∫–æ–π –∏ —Å–±–æ—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.", "q2": "–°—Ä–µ–¥—Å—Ç–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è", "a2": "–î–∏—Å–ø–µ—Ç—á–µ—Ä, MMC, RDP.", "pract": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–ª—É–∂–±—ã.", "p_sol": "–ê–≤—Ç–æ-–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å–±–æ–µ."},
    "16": {"q1": "–ò–Ω—Ñ–æ—Ä–º. –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "a1": "–ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å, —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å.", "q2": "–¢–∏–ø—ã —É–≥—Ä–æ–∑", "a2": "–í–∏—Ä—É—Å—ã, —Ö–∞–∫–µ—Ä—ã, –∏–Ω—Å–∞–π–¥–µ—Ä—ã, —Å–±–æ–∏.", "pract": "–ü–æ–∏—Å–∫ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.", "p_sol": "–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π."},
    "17": {"q1": "Service Desk", "a1": "–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.", "q2": "SLA", "a2": "–î–æ–≥–æ–≤–æ—Ä –æ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–∞–∫—Ü–∏–∏ –∏ —Ä–µ—à–µ–Ω–∏—è.", "pract": "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞—è–≤–æ–∫.", "p_sol": "P1 (–∞–≤–∞—Ä–∏—è) -> P3 (–∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è)."},
    "18": {"q1": "–ê–ª–≥–æ—Ä–∏—Ç–º —Ç–µ—Ö–ø–æ–¥–¥–µ—Ä–∂–∫–∏", "a1": "–ü—Ä–∏–µ–º -> –ê–Ω–∞–ª–∏–∑ -> –†–µ—à–µ–Ω–∏–µ -> –ó–∞–∫—Ä—ã—Ç–∏–µ.", "q2": "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞—è–≤–æ–∫", "a2": "–ò–Ω—Ü–∏–¥–µ–Ω—Ç, –ó–∞–ø—Ä–æ—Å, –ò–∑–º–µ–Ω–µ–Ω–∏–µ.", "pract": "–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è.", "p_sol": "–ê–Ω–∞–ª–∏–∑ –≤–ª–∏—è–Ω–∏—è –∏ —Å—Ä–æ—á–Ω–æ—Å—Ç–∏."},
    "19": {"q1": "–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –ê–ò–°", "a1": "–ü–ª–∞–Ω–æ–≤–æ–µ –≤–Ω–µ—Å–µ–Ω–∏–µ –ø—Ä–∞–≤–æ–∫ –≤ —Å–∏—Å—Ç–µ–º—É.", "q2": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∏–º", "a2": "–¢–µ—Å—Ç—ã, –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞, –º–∏–Ω–∏–º—É–º –ø—Ä–æ—Å—Ç–æ—è.", "pract": "–†–µ–≥–ª–∞–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π.", "p_sol": "–ë—ç–∫–∞–ø -> –¢–µ—Å—Ç -> –£—Å—Ç–∞–Ω–æ–≤–∫–∞."},
    "20": {"q1": "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ü–û", "a1": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º.", "q2": "–¶–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è", "a2": "–ü–æ–∏—Å–∫ –±–∞–≥–æ–≤ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.", "pract": "–í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Ç–µ—Å—Ç–∞.", "p_sol": "–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç –ø–æ—Å–ª–µ –ø—Ä–∞–≤–æ–∫."},
    "21": {"q1": "–°—Ç–æ—Ä–æ–Ω–Ω–µ–µ –ü–û", "a1": "–í–Ω–µ—à–Ω–∏–µ —É—Ç–∏–ª–∏—Ç—ã –∏ –∏—Ö —Å–≤—è–∑—å —Å –ê–ò–°.", "q2": "–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏", "a2": "–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Ñ–æ—Ä–º–∞—Ç–æ–≤, —Ç–∞–π–º–∞—É—Ç—ã.", "pract": "–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–∫–∏.", "p_sol": "–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞."},
    "22": {"q1": "–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏—è", "a1": "–ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∏ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.", "q2": "–ü–æ–ª–∏—Ç–∏–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏", "a2": "–ü—Ä–∞–≤–∏–ª–∞ –¥–æ—Å—Ç—É–ø–∞, –ø–∞—Ä–æ–ª–µ–π –∏ –∞—É–¥–∏—Ç–∞.", "pract": "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞.", "p_sol": "–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤ –Ω–∞ –ø–∞–ø–∫—É."},
    "23": {"q1": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ê–ò–°", "a1": "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π.", "q2": "–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞–≥—Ä—É–∑–∫–∏", "a2": "–ö–æ–Ω—Ç—Ä–æ–ª—å CPU, RAM, Disk.", "pract": "–ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∑–∫–∏.", "p_sol": "–ü–æ–∏—Å–∫ –ø—Ä–æ—Ü–µ—Å—Å–∞-–≤–∏–Ω–æ–≤–Ω–∏–∫–∞."},
    "24": {"q1": "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è", "a1": "–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞ –∞–¥–º–∏–Ω–∞ –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.", "q2": "–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è", "a2": "–ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å, –ø–æ–ª–Ω–æ—Ç–∞, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞.", "pract": "–°–æ–∑–¥–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é.", "p_sol": "–®–∞–≥ -> –û–ø–∏—Å–∞–Ω–∏–µ -> –†–µ–∑—É–ª—å—Ç–∞—Ç."},
    "25": {"q1": "–û—à–∏–±–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π", "a1": "–ß–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–π —Ñ–∞–∫—Ç–æ—Ä (—É–¥–∞–ª–µ–Ω–∏–µ, –ø–∞—Ä–æ–ª–∏).", "q2": "–ú–µ—Ç–æ–¥–∏–∫–∞ –∞–Ω–∞–ª–∏–∑–∞", "a2": "–ü–æ–∏—Å–∫ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω –º–∞—Å—Å–æ–≤—ã—Ö –∂–∞–ª–æ–±.", "pract": "–†–∞–∑–±–æ—Ä –æ–±—Ä–∞—â–µ–Ω–∏–π.", "p_sol": "–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –∂–∞–ª–æ–± –ø–æ —Ç–∏–ø—É."},
}

# --- 4. –£–ü–†–ê–í–õ–ï–ù–ò–ï –°–û–°–¢–û–Ø–ù–ò–ï–ú (SESSION STATE) ---
if 'ex_ticket' not in st.session_state: st.session_state.ex_ticket = None
if 'ex_step' not in st.session_state: st.session_state.ex_step = 1
if 'quiz_active' not in st.session_state: st.session_state.quiz_active = False
if 'quiz_count' not in st.session_state: st.session_state.quiz_count = 1

# --- 5. –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° ---
st.title("üñ• AIS EXAM MASTER ELITE v3.0")

# –í–ê–ñ–ù–û: –ü—Ä–∏—Å–≤–∞–∏–≤–∞–µ–º –≤–∫–ª–∞–¥–∫–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º
tab_study, tab_exam, tab_lab, tab_any = st.tabs([
    "üìñ –ë–ê–ó–ê –ó–ù–ê–ù–ò–ô", 
    "üé´ –≠–ö–ó–ê–ú–ï–ù-–°–ò–ú–£–õ–Ø–¢–û–†", 
    "üß™ AI –õ–ê–ë–û–†–ê–¢–û–†–ò–Ø", 
    "üåç –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –¢–ï–°–¢"
])

# --- –í–ö–õ–ê–î–ö–ê 1: –£–ß–ò–¢–¨ ---
with tab_study:
    st.header("üìö –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫: –¢–µ–æ—Ä–∏—è + –ü—Ä–∞–∫—Ç–∏–∫–∞")
    cols = st.columns(2)
    for i, num in enumerate(sorted(tickets_data.keys(), key=int)):
        with cols[i % 2].expander(f"üì¶ –ë–ò–õ–ï–¢ ‚Ññ{num}"):
            d = tickets_data[num]
            
            # –ê—É–¥–∏–æ
            audio_path = f"audio/{num}.mp3"
            if os.path.exists(audio_path):
                st.audio(audio_path, format="audio/mp3")
            else:
                st.caption(f"üîà –ê—É–¥–∏–æ {num}.mp3 –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")
                
            st.markdown(f"**–í–æ–ø—Ä–æ—Å 1:** {d['q1']}")
            st.info(d['a1'])
            st.markdown(f"**–í–æ–ø—Ä–æ—Å 2:** {d['q2']}")
            st.info(d['a2'])
            st.markdown("---")
            st.success(f"üõ† **–ü–†–ê–ö–¢–ò–ö–ê:** {d['pract']}")
            st.warning(f"üìù **–ê–õ–ì–û–†–ò–¢–ú:** {d['p_sol']}")

# --- –í–ö–õ–ê–î–ö–ê 2: –≠–ö–ó–ê–ú–ï–ù ---
with tab_exam:
    st.header("üé´ –°–∏–º—É–ª—è—Ç–æ—Ä —ç–∫–∑–∞–º–µ–Ω–∞")
    
    if st.button("üé≤ –í–´–¢–Ø–ù–£–¢–¨ –°–õ–£–ß–ê–ô–ù–´–ô –ë–ò–õ–ï–¢", key="btn_draw"):
        st.session_state.ex_ticket = random.choice(list(tickets_data.keys()))
        st.session_state.ex_step = 1
        st.rerun()

    if st.session_state.ex_ticket:
        t_num = st.session_state.ex_ticket
        step = st.session_state.ex_step
        data = tickets_data[t_num]
        
        st.progress(step / 3)
        st.subheader(f"–ë–∏–ª–µ—Ç ‚Ññ{t_num} | –®–∞–≥ {step} –∏–∑ 3")
        
        q = data['q1'] if step == 1 else (data['q2'] if step == 2 else f"–ü–†–ê–ö–¢–ò–ö–ê: {data['pract']}")
        ref = data['a1'] if step == 1 else (data['a2'] if step == 2 else data['p_sol'])
        
        st.info(q)
        user_ans = st.text_area("–¢–≤–æ–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –æ—Ç–≤–µ—Ç:", key=f"ex_area_{step}_{t_num}", height=150)
        
        c1, c2 = st.columns(2)
        if c1.button("üìä –ü–†–û–í–ï–†–ò–¢–¨"):
            if user_ans:
                with st.spinner("–ê–Ω–∞–ª–∏–∑..."):
                    sys_p = "–¢—ã ‚Äî Senior IT Architect. –ü—Ä–æ–≤–µ—Ä—å –æ—Ç–≤–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Å—Ç—Ä–æ–≥–æ. –ï—Å–ª–∏ –Ω–µ—Ç —Ç–µ—Ä–º–∏–Ω–æ–≤ ‚Äî —Å—Ç–∞–≤—å 2."
                    user_p = f"–í–æ–ø—Ä–æ—Å: {q}\n–≠—Ç–∞–ª–æ–Ω: {ref}\n–û—Ç–≤–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞: {user_ans}\n–û—Ü–µ–Ω–∏ –∂–µ—Å—Ç–∫–æ –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ: –û—Ü–µ–Ω–∫–∞, –û—à–∏–±–∫–∏, –ö–∞–∫ –Ω–∞–¥–æ."
                    print_terminal(call_ai(sys_p, user_p))
        
        if step < 3:
            if c2.button("–î–ê–õ–ï–ï üëâ"):
                st.session_state.ex_step += 1
                st.rerun()
        else:
            if c2.button("üèÅ –ó–ê–í–ï–†–®–ò–¢–¨"):
                st.balloons()
                st.session_state.ex_ticket = None
                st.rerun()

# --- –í–ö–õ–ê–î–ö–ê 3: AI –õ–ê–ë–û–†–ê–¢–û–†–ò–Ø ---
with tab_lab:
    st.header("üß™ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–≤")
    topic_l = st.selectbox("–°—Ñ–µ—Ä–∞:", ["–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å", "–°–µ—Ç–∏", "–ë–î", "Windows/Linux"])
    
    if st.button("üî• –°–û–ó–î–ê–¢–¨ –ê–í–ê–†–ò–Æ"):
        with st.spinner("–ì–µ–Ω–µ—Ä–∞—Ü–∏—è..."):
            p = f"–û–ø–∏—à–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ–π –≤ –ê–ò–° –ø–æ —Ç–µ–º–µ {topic_l}. –ù–µ –ø–∏—à–∏ —Ä–µ—à–µ–Ω–∏–µ."
            st.session_state.lab_q = call_ai("–¢—ã –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∞–≤–∞—Ä–∏–π–Ω–æ–π —Å–ª—É–∂–±—ã.", p)
    
    if 'lab_q' in st.session_state:
        st.error(st.session_state.lab_q)
        ans_lab = st.text_area("–¢–≤–æ–π –ø–ª–∞–Ω —Å–ø–∞—Å–µ–Ω–∏—è:", key="lab_input")
        if st.button("üéØ –û–¶–ï–ù–ò–¢–¨ –ü–õ–ê–ù"):
            print_terminal(call_ai("–¢—ã –≥–ª–∞–≤–Ω—ã–π –∏–Ω–∂–µ–Ω–µ—Ä.", f"–ó–∞–¥–∞—á–∞: {st.session_state.lab_q}\n–û—Ç–≤–µ—Ç: {ans_lab}. –û—Ü–µ–Ω–∏."))

# --- –í–ö–õ–ê–î–ö–ê 4: –£–ù–ò–í–ï–†–°–ê–õ–¨–ù–´–ô –¢–ï–°–¢ ---
with tab_any:
    st.header("üåç –ú–∞—Ä–∞—Ñ–æ–Ω –ø–æ –ª—é–±–æ–π —Ç–µ–º–µ")
    
    if not st.session_state.quiz_active:
        t_input = st.text_input("–í–≤–µ–¥–∏ —Ç–µ–º—É –¥–ª—è –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã (–Ω–∞–ø—Ä. Minecraft, –ü–∏—Ç–æ–Ω, –ò—Å—Ç–æ—Ä–∏—è):")
        if st.button("üöÄ –ù–ê–ß–ê–¢–¨"):
            if t_input:
                st.session_state.quiz_topic = t_input
                st.session_state.quiz_count = 1
                st.session_state.quiz_active = True
                st.rerun()
    else:
        q_num = st.session_state.quiz_count
        st.info(f"–¢–µ–º–∞: {st.session_state.quiz_topic} | –í–æ–ø—Ä–æ—Å {q_num} –∏–∑ 10")
        st.progress(q_num / 10)
        
        q_key = f"q_any_{q_num}_{st.session_state.quiz_topic}"
        if q_key not in st.session_state:
            with st.spinner("–ò–ò –ø–∏—à–µ—Ç –≤–æ–ø—Ä–æ—Å..."):
                st.session_state[q_key] = call_ai("–¢—ã –≤–µ–¥—É—â–∏–π –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã.", f"–ó–∞–¥–∞–π —Å–ª–æ–∂–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø–æ —Ç–µ–º–µ {st.session_state.quiz_topic}. –í–æ–ø—Ä–æ—Å ‚Ññ{q_num}.")
        
        st.subheader(st.session_state[q_key])
        u_ans = st.text_area("–¢–≤–æ–π –æ—Ç–≤–µ—Ç:", key=f"ans_any_{q_num}")
        
        col_ch, col_ne = st.columns(2)
        if col_ch.button("üß™ –ü–†–û–í–ï–†–ò–¢–¨"):
            print_terminal(call_ai("–¢—ã —Å—É–¥—å—è.", f"–í–æ–ø—Ä–æ—Å: {st.session_state[q_key]}\n–û—Ç–≤–µ—Ç: {u_ans}. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç—Ä–æ–≥–æ."))
        
        if q_num < 10:
            if col_ne.button("–î–ê–õ–¨–®–ï ‚è≠"):
                st.session_state.quiz_count += 1
                st.rerun()
        else:
            if col_ne.button("üèÅ –§–ò–ù–ò–®"):
                st.balloons()
                st.session_state.quiz_active = False
                st.rerun()
        
        if st.button("‚ùå –í–´–ô–¢–ò"):
            st.session_state.quiz_active = False
            st.rerun()
